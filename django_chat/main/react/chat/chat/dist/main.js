!function(e){function n(n){for(var r,i,l=n[0],c=n[1],s=n[2],d=0,m=[];d<l.length;d++)i=l[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&m.push(o[i][0]),o[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(u&&u(n);m.length;)m.shift()();return a.push.apply(a,s||[]),t()}function t(){for(var e,n=0;n<a.length;n++){for(var t=a[n],r=!0,l=1;l<t.length;l++){var c=t[l];0!==o[c]&&(r=!1)}r&&(a.splice(n--,1),e=i(i.s=t[0]))}return e}var r={},o={0:0},a=[];function i(n){if(r[n])return r[n].exports;var t=r[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=e,i.c=r,i.d=function(e,n,t){i.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,n){if(1&n&&(e=i(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(i.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)i.d(t,r,function(n){return e[n]}.bind(null,r));return t},i.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(n,"a",n),n},i.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},i.p="";var l=window.webpackJsonp=window.webpackJsonp||[],c=l.push.bind(l);l.push=n,l=l.slice();for(var s=0;s<l.length;s++)n(l[s]);var u=c;a.push([53,1]),t()}({34:function(e,n){e.exports="data:image/svg+xml,%3C?xml version='1.0' encoding='utf-8'?%3E %3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' style='margin: auto; background: rgb(241, 242, 243) none repeat scroll 0%25 0%25; display: block; shape-rendering: auto; animation-play-state: running; animation-delay: 0s;' width='200px' height='200px' viewBox='0 0 100 100' preserveAspectRatio='xMidYMid'%3E %3Ccircle cx='50' cy='50' fill='none' stroke='%231d3f72' stroke-width='5' r='35' stroke-dasharray='164.93361431346415 56.97787143782138' style='animation-play-state: running; animation-delay: 0s;'%3E %3CanimateTransform attributeName='transform' type='rotate' repeatCount='indefinite' dur='1s' values='0 50 50;360 50 50' keyTimes='0;1' style='animation-play-state: running; animation-delay: 0s;'%3E%3C/animateTransform%3E %3C/circle%3E %3C!-- %5Bldio%5D generated by https://loading.io/ --%3E%3C/svg%3E"},35:function(e,n,t){"use strict";(function(e){t.d(n,"a",(function(){return r}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function r(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}}).call(this,t(26))},53:function(e,n,t){"use strict";t.r(n);var r=t(1),o=t.n(r),a=t(9),i=t.n(a),l=t(2),c=t.n(l),s=t(6),u=t.n(s),d=t(3),m=t.n(d),f=t(4);function p(){var e=m()(["\n  background: gray;\n  display: grid;\n  grid-template-rows: 70px auto;\n"]);return p=function(){return e},e}function g(){var e=m()(["\n  display: flex;\n  overflow-y: scroll;\n  flex-flow: column;\n  margin-bottom: 0px;\n  div.tag {\n    background: lightgray;\n    text-align: center;\n  }\n  li.listContent {\n    display: flex;\n    justify-content: space-around;\n    background: rgb(231, 234, 238);\n    cursor: pointer;\n    align-items: center;\n    transition-duration: 1s;\n    &:hover {\n      background: #f2f2f2;\n    }\n    p {\n      margin: auto;\n      padding: 15px 10px;\n      flex: 4 1 50%;\n      word-wrap: anywhere;\n    }\n    span {\n      flex: 1 1 10%;\n    }\n  }\n"]);return g=function(){return e},e}function b(){var e=m()(["\n  padding: 10px 2px;\n  display: flex;\n  background: rgb(82, 93, 104);\n"]);return b=function(){return e},e}function h(){var e=m()(["\n  padding: 10px 10px;\n  margin: auto;\n\n  background: transparent;\n  border: 1px solid white;\n  color: white;\n  border: 0;\n  border-bottom: 1px solid wheat;\n"]);return h=function(){return e},e}var x=f.b.input(h()),v=f.b.div(b()),y=f.b.ul(g()),w=f.b.div(p()),E="";try{E=JSON.parse(document.querySelector("#user_id").textContent)}catch(e){E="1"}var S=function(e){var n=Object(r.useState)({isFetching:!0}),t=c()(n,2),a=(t[0],t[1],Object(r.useState)([])),i=c()(a,2),l=i[0],s=i[1],u=Object(r.useState)(l),d=c()(u,2),m=d[0],f=d[1],p=Object(r.useState)(""),g=c()(p,2),b=g[0],h=g[1],S=function(){fetch(function(e){return window.origin+"/chat/api/"+e+"/rooms"}(E)).then((function(e){return e.json()})).then((function(e){console.log(e),s(e),f(e)}))};Object(r.useEffect)((function(){S()}),[]),Object(r.useEffect)((function(){console.log("props.refresh"+e.refresh),e.refresh&&(console.log("refreshing ..........."),S(),e.dataRefreshed())}),[e.refresh]);return o.a.createElement(w,null,o.a.createElement(v,null,o.a.createElement(x,{type:"text",id:"search",value:b,placeholder:"Search",onChange:function(e){var n=e.target,t=n.name,r=n.value;console.log(t,r),h(r),f(r?l.filter((function(e){return e.name.includes(r)})):l)},name:"search"})),o.a.createElement(y,null,o.a.createElement("div",{className:"tag"},"Rooms"),m.map((function(n){return n.members.length>=3?o.a.createElement(k,{type:"room",onClick:e.onClick,room_name:n.name,room_id:n.id}):""})),o.a.createElement("div",{className:"tag"},"Users"),m.map((function(n){return 2==n.members.length?o.a.createElement(k,{type:"user",onClick:e.onClick,room_name:n.name,room_id:n.id}):""}))))},k=function(e){var n="room"==e.type?"listContent room ":"listContent user";return o.a.createElement("li",{className:n},o.a.createElement("p",{onClick:e.onClick,"data-id":e.room_id},e.room_name))};function O(){var e=m()(["\n  position: absolute;\n  background: #cdf0d3;\n  height: auto;\n  color: #716e6e;\n  font-weight: 800;\n  padding: 10px;\n  width: 100%;\n  top: -40%;\n  display: flex;\n  flex-flow: row;\n  div#icon {\n    flex: 1 1 0%;\n    svg {\n      font-size: 40px;\n    }\n  }\n  div#right {\n    display: flex;\n    flex-flow: row;\n    margin-left: auto;\n    a {\n      padding: 10px 12px;\n      background: #3a3b3c;\n      color: white;\n      margin: auto 10px;\n      cursor: pointer;\n    }\n  }\n  div#left {\n    display: flex;\n    flex: 1 1 40%;\n    flex-flow: column;\n    p {\n      margin: 0px;\n    }\n  }\n"]);return O=function(){return e},e}function j(){var e=m()(["\n  width: 30%;\n  height: 30%;\n  max-height: 300px;\n  min-height: 200px;\n  background: white;\n  position: absolute;\n  box-shadow: 2px 2px 2px 3px #c4bbbb;\n  padding: 12px;\n  left: 50%;\n  top: 50%;\n  margin-left: -100px;\n  margin-top: -100px;\n  svg {\n    position: absolute;\n    top: -8px;\n    right: -8px;\n    cursor: pointer;\n  }\n  div.userDetails {\n    div {\n      display: flex;\n    }\n  }\n"]);return j=function(){return e},e}function _(){var e=m()(["\n  height: 100%;\n  background: #a1a6bfb8 none repeat scroll 0% 0%;\n  width: 100%;\n  z-index: 1;\n  display: flex;\n  position: absolute;\n  img {\n    margin: auto;\n    height: 100px;\n  }\n"]);return _=function(){return e},e}function C(){var e=m()(["\n  background: white;\n  border: 1px solid white;\n  border: 1px solid white;\n  border-radius: 5px;\n  padding: 10px;\n"]);return C=function(){return e},e}function N(){var e=m()(["\n  ","\n  border-radius: 5px;\n\n  border: 2px solid #3282b8;\n  padding: 10px;\n  cursor: pointer;\n  text-align: center;\n  ","\n  &:hover {\n  ","\n"]);return N=function(){return e},e}function R(){var e=m()(["\n  padding: 20px;\n  font-size: 20px;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  background: #8ac6dd;\n  &:hover {\n    background: #bad9c2;\n  }\n"]);return R=function(){return e},e}function W(){var e=m()(["\n  padding: 10px 30px;\n  border-top: 1px solid;\n  grid-column: 1/2;\n  display: flex;\n  align-items: center;\n  padding: 0px;\n  background: #e0e2e8;\n  height: 80px;\n  position: relative;\n  .fileSelect {\n    padding: 10px 20px;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    svg {\n      font-size: 25px;\n    }\n  }\n  div.InputWrapper {\n    display: flex;\n    flex: 1 1 80%;\n    align-items: center;\n    height: 100%;\n    textarea {\n      flex: 1 1 30%;\n      background: inherit;\n    }\n  }\n"]);return W=function(){return e},e}function F(){var e=m()(["\n  border: 0px;\n  padding: 10px;\n  resize: none;\n"]);return F=function(){return e},e}function M(){var e=m()(["\n  display: flex;\n  overflow-x: auto;\n\n  div.userName {\n    margin: 5px;\n    background: aliceblue;\n    display: flex;\n    align-items: center;\n    justify-content: space-around;\n    cursor: pointer;\n    &:hover {\n      background: #e0f3ff;\n    }\n  }\n"]);return M=function(){return e},e}function P(){var e=m()(["\n  border: 1px solid #e3dddd;\n  padding: 10px 30px;\n  max-height: 500px;\n  overflow-y: scroll;\n  grid-column: 1/2;\n"]);return P=function(){return e},e}function T(){var e=m()(["\n  display: flex;\n  flex-flow: column;\n  margin: 10px 0px;\n  ","\n  div {\n    width: 70%;\n    p.message {\n      background: aliceblue;\n      padding: 14px 10px;\n      margin: 2px;\n      display: flex;\n      align-items: center;\n      svg {\n        font-size: 30px;\n        margin-right: 10px;\n      }\n      a {\n        word-wrap: anywhere;\n      }\n    }\n    p.time {\n      margin: 2px;\n      font-weight: 200;\n      ","\n    }\n    p.userName {\n      margin: 10px;\n      color: lightcoral;\n      ","\n      font-weight: 800;\n    }\n  }\n"]);return T=function(){return e},e}function z(){var e=m()(["\n  margin: 10px;\n"]);return z=function(){return e},e}function A(){var e=m()(["\n  width: 10px;\n  height: 10px;\n  background: ",";\n  border-radius: 10px;\n  margin: 10px;\n"]);return A=function(){return e},e}function I(){var e=m()(["\n  margin: 10px;\n"]);return I=function(){return e},e}function J(){var e=m()(["\n  display: flex;\n  flex-flow: column;\n  padding: 10px;\n"]);return J=function(){return e},e}function L(){var e=m()(["\n  display: grid;\n  grid-template-rows: minmax(18vh, 18vh) minmax(300px, auto) minmax(auto, 10vh);\n  grid-template-columns: 100%;\n  position: relative;\n"]);return L=function(){return e},e}function D(){var e=m()(["\n  display: grid;\n  grid-template-columns: minmax(200px, 20%) minmax(auto, 80%);\n  grid-template-rows: 100vh;\n"]);return D=function(){return e},e}var q=f.b.div(D()),B=(f.b.div(L()),f.b.div(J()),f.b.h4(I()),f.b.div(A(),(function(e){return e.status?"lightgreen":"red"})),f.b.div(z()),f.b.div(T(),(function(e){return e.userSelf&&" align-items: end;\n    "}),(function(e){return e.userSelf&&" text-align: right; "}),(function(e){return e.userSelf&&" text-align: right; color: lightblue;"})),f.b.div(P()),f.b.div(M()),f.b.textarea(F()),f.b.div(W()),f.b.span(R()),f.b.a(N(),(function(e){return e.light?"background: #27496d;color: white !important;":"background: #3282b8; color: white !important;"}),(function(e){return e.right?"text-align:right;":e.left?"text-align:left;":"text-align:center;"}),(function(e){return e.light,""}))),U=f.b.input(C()),V=f.b.div(_());f.b.div(j()),f.b.div(O()),t(28);function H(){var e=m()(["\n  height: 100%;\n  background: #a1a6bfb8 none repeat scroll 0% 0%;\n  width: 100%;\n  z-index: 1;\n  display: flex;\n  position: absolute;\n  img {\n    margin: auto;\n    height: 100px;\n  }\n"]);return H=function(){return e},e}function Y(){var e=m()(["\n  background: gray;\n  display: grid;\n  grid-template-rows: 70px auto;\n"]);return Y=function(){return e},e}function X(){var e=m()(["\n  display: flex;\n  overflow-y: scroll;\n  flex-flow: column;\n  margin-bottom: 0px;\n  div.tag {\n    background: lightgray;\n    text-align: center;\n  }\n  li.listContent {\n    display: flex;\n    justify-content: space-around;\n    background: rgb(231, 234, 238);\n    cursor: pointer;\n    align-items: center;\n    transition-duration: 1s;\n    &:hover {\n      background: #f2f2f2;\n    }\n    p {\n      margin: auto;\n      padding: 15px 10px;\n      flex: 4 1 50%;\n      word-wrap: anywhere;\n    }\n    span {\n      flex: 1 1 10%;\n    }\n  }\n"]);return X=function(){return e},e}function $(){var e=m()(["\n  padding: 10px 2px;\n  display: flex;\n  background: rgb(82, 93, 104);\n"]);return $=function(){return e},e}function G(){var e=m()(["\n  padding: 10px 10px;\n  margin: auto;\n\n  background: transparent;\n  border: 1px solid white;\n  color: white;\n  border: 0;\n  border-bottom: 1px solid wheat;\n"]);return G=function(){return e},e}function K(){var e=m()(["\n  margin: 10px;\n"]);return K=function(){return e},e}function Q(){var e=m()(["\n  display: flex;\n  flex-flow: column;\n  padding: 10px;\n"]);return Q=function(){return e},e}function Z(){var e=m()(["\n  display: grid;\n  grid-template-rows: minmax(18vh, 18vh) minmax(300px, auto) minmax(auto, 10vh);\n  grid-template-columns: 100%;\n  position: relative;\n"]);return Z=function(){return e},e}function ee(){var e=m()(["\n  display: grid;\n  grid-template-columns: minmax(200px, 20%) minmax(auto, 80%);\n  grid-template-rows: 100vh;\n"]);return ee=function(){return e},e}f.b.div(ee());var ne=f.b.div(Z()),te=f.b.div(Q()),re=f.b.h4(K()),oe=(f.b.input(G()),f.b.div($()),f.b.ul(X()),f.b.div(Y()),f.b.div(H()),function(e){var n=("https:"===window.location.protocol?"wss://":"ws://")+window.location.host+"/ws/django_chatter/chatrooms/chat/"+e+"/";return console.log(n),n}),ae=function(){var e;return e=("https:"===window.location.protocol?"wss://":"ws://")+window.location.host+"/ws/django_chatter/chatrooms/user/",console.log(e),e},ie=t(29),le=t.n(ie);function ce(){var e=m()(["\n  padding: 10px 30px;\n  border-top: 1px solid;\n  grid-column: 1/2;\n  display: flex;\n  align-items: center;\n  padding: 0px;\n  background: #e0e2e8;\n  height: 80px;\n  position: relative;\n  .fileSelect {\n    padding: 10px 20px;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    svg {\n      font-size: 25px;\n    }\n  }\n  div.InputWrapper {\n    display: flex;\n    flex: 1 1 80%;\n    align-items: center;\n    height: 100%;\n    textarea {\n      flex: 1 1 30%;\n      background: inherit;\n    }\n  }\n"]);return ce=function(){return e},e}function se(){var e=m()(["\n  padding: 20px;\n  font-size: 20px;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  background: #8ac6dd;\n  &:hover {\n    background: #bad9c2;\n  }\n"]);return se=function(){return e},e}function ue(){var e=m()(["\n  border: 0px;\n  padding: 10px;\n  resize: none;\n"]);return ue=function(){return e},e}var de=f.b.textarea(ue()),me=f.b.span(se()),fe=f.b.div(ce()),pe=t(19),ge=t(30),be=[".doc",".docx","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],he=["image/apng","image/bmp","image/gif","image/jpeg","image/jpg","image/pjpeg","image/png","image/svg+xml","image/tiff","image/webp","image/x-icon"],xe=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],ve=["application/xml","text/xml","text/csv"],ye=t(7),we=function(e){var n;return e&&("application/pdf"===e&&(n=o.a.createElement(ye.d,{style:{color:"#c82020"}})),be.includes(e)&&(n=o.a.createElement(ye.e,{style:{color:"#298bc6"}}),console.log("word")),he.includes(e)&&(n=o.a.createElement(ye.f,null)),xe.includes(e)&&(n=o.a.createElement(ye.c,{style:{color:"green"}})),ve.includes(e)&&(n=o.a.createElement(ye.b,{style:{color:"orange"}})),""===e&&(console.log("else"),n=o.a.createElement(ye.a,null))),n};function Ee(){var e=m()(["\n  position: absolute;\n  background: #cdf0d3;\n  height: auto;\n  color: #716e6e;\n  font-weight: 800;\n  padding: 10px;\n  width: 100%;\n  top: -40%;\n  display: flex;\n  flex-flow: row;\n  div#icon {\n    flex: 1 1 0%;\n    svg {\n      font-size: 40px;\n    }\n  }\n  div#right {\n    display: flex;\n    flex-flow: row;\n    margin-left: auto;\n    a {\n      padding: 10px 12px;\n      background: #3a3b3c;\n      color: white;\n      margin: auto 10px;\n      cursor: pointer;\n    }\n  }\n  div#left {\n    display: flex;\n    flex: 1 1 40%;\n    flex-flow: column;\n    p {\n      margin: 0px;\n    }\n  }\n"]);return Ee=function(){return e},e}var Se=f.b.div(Ee()),ke=function(e){var n,t;if(Object(r.useEffect)((function(){var e=document.querySelector("#file-preview");console.log(e);var n="-"+e.offsetHeight+"px";e.style.top=n})),e.fileSelected.length){n=e.fileSelected[0]?o.a.createElement("p",null,e.fileSelected[0].name):"";var a=e.fileSelected[0].type;return console.log(a),t=we(a),o.a.createElement(Se,{id:"file-preview"},o.a.createElement("div",{id:"icon"},t),o.a.createElement("div",{id:"left"},o.a.createElement("p",null,"Sending Files"),n),o.a.createElement("div",{id:"right"},o.a.createElement("a",{onClick:function(){e.onFileSend()}},"Send File"),o.a.createElement("a",{onClick:e.onFileSendCancel},"Cancel")))}},Oe=function(e){var n=Object(r.useState)([]),t=c()(n,2),a=t[0],i=t[1],l=Object(r.useState)(""),s=c()(l,2),u=s[0],d=s[1];Object(r.useEffect)((function(){i([])}),[e.socket]);return o.a.createElement(fe,null,a.length?o.a.createElement(ke,{onFileSend:function(){try{var n=document.getElementById("attachFile").files[0];console.log(n);var t=new FileReader;t.onload=function(r){console.log(t.result),e.socket.send(JSON.stringify({message_type:"file",filename:n.name,filetype:n.type,file:t.result.split(",",2)[1],room_id:e.room_id})),i([])},t.readAsDataURL(n)}catch(e){console.log("inside send image")}},onFileSendCancel:function(e){i([]),e.target.files=""},fileSelected:a,socket:e.socket}):"",o.a.createElement("div",{className:"fileSelect",onClick:function(e){console.log("yo"),console.log(a.length)}},o.a.createElement("label",{for:"attachFile"}," ",o.a.createElement(ge.a,null)," "),o.a.createElement("input",{type:"file",name:"attachFile",hidden:!0,id:"attachFile",onChange:function(e){try{console.log("changed"),console.log(e.target.files[0]),i([e.target.files[0]])}catch(e){console.log("change")}},accept:"image/*,.doc,.docx,.xml,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document"})),o.a.createElement("div",{className:"InputWrapper"},o.a.createElement(de,{onChange:function(e){console.log(e.target);e.target;var n=e.target.value;d(n),console.log(n)},value:u,type:"text",placeholder:"Type text to send....",style:{flex:"1 1 30%"}}),o.a.createElement(me,{onClick:function(n){""!=n.target.value&&function(n){if(console.log("send message"),e.socket.readyState==e.socket.OPEN){var t=JSON.stringify({message_type:"text",message:u,sender:e.username,room_id:e.room_id});e.socket.send(t),d("")}}()}},o.a.createElement(pe.a,null))))};function je(){var e=m()(["\n  border: 1px solid #e3dddd;\n  padding: 10px 30px;\n  max-height: 500px;\n  overflow-y: scroll;\n  grid-column: 1/2;\n"]);return je=function(){return e},e}function _e(){var e=m()(["\n  display: flex;\n  flex-flow: column;\n  margin: 10px 0px;\n  ","\n  div {\n    width: 70%;\n    p.message {\n      background: aliceblue;\n      padding: 14px 10px;\n      margin: 2px;\n      display: flex;\n      align-items: center;\n      svg {\n        font-size: 30px;\n        margin-right: 10px;\n      }\n      a {\n        word-wrap: anywhere;\n      }\n    }\n    p.time {\n      margin: 2px;\n      font-weight: 200;\n      ","\n    }\n    p.userName {\n      margin: 10px;\n      color: lightcoral;\n      ","\n      font-weight: 800;\n    }\n  }\n"]);return _e=function(){return e},e}var Ce=f.b.div(_e(),(function(e){return e.userSelf&&" align-items: end;\n    "}),(function(e){return e.userSelf&&" text-align: right; "}),(function(e){return e.userSelf&&" text-align: right; color: lightblue;"})),Ne=f.b.div(je()),Re=function(e){var n=Object(r.useState)(e.messages),t=c()(n,2),a=t[0],i=t[1];Object(r.useEffect)((function(){i(e.messages)}),[e.messages]);Object(r.useEffect)((function(){e.messages.length&&document.querySelector("#message_list").lastElementChild.scrollIntoView()}),[]);var l={};a.length>=1&&(l=a.map((function(n){return o.a.createElement(Ce,{userSelf:n.sender__username==e.username,key:n.id,"data-id":n.id},o.a.createElement("div",null,o.a.createElement("p",{className:"userName"},n.sender__username),function(e){return null==e.text?["png","jpeg","gif","jpg"].includes(e.file.split(".")[1])?o.a.createElement("img",{src:window.origin+"/media/"+e.file,style:{width:"99%",height:"200px"}}):["docx","doc"].includes(e.file.split(".")[1])?o.a.createElement("p",{className:"message"}," ",o.a.createElement(ye.e,{style:{color:"#298bc6"}}),o.a.createElement("a",{href:"/media/"+e.file,target:"_blank"},e.file)):["xlsx","xls"].includes(e.file.split(".")[1])?o.a.createElement("p",{className:"message"}," ",o.a.createElement(ye.c,{style:{color:"green"}}),o.a.createElement("a",{href:"/media/"+e.file,target:"_blank"},e.file)):["pdf"].includes(e.file.split(".")[1])?o.a.createElement("p",{className:"message"},o.a.createElement(ye.d,{style:{color:"#c82020"}}),o.a.createElement("a",{href:"/media/"+e.file,target:"_blank"},e.file)):["xml","csv"].includes(e.file.split(".")[1])?o.a.createElement("p",{className:"message"},o.a.createElement(ye.b,{style:{color:"orange"}}),o.a.createElement("a",{href:"/media/"+e.file,target:"_blank"},e.file)):o.a.createElement("p",null,"What the hell"):o.a.createElement("p",{className:"message"},e.text)}(n),o.a.createElement("p",{className:"time"},n.date_created)))})));var s=0!=a.length?l:"<p>No Messages Available</p>";return o.a.createElement(Ne,{onScroll:e.onScroll,onLoad:function(){},id:"message_list"},s)};Re.propTypes={username:u.a.string.isRequired,room_id:u.a.string.isRequired,room_name:u.a.string.isRequired,messages:u.a.arrayOf(u.a.shape({id:u.a.number,text:u.a.string,date_created:u.a.string,sender:u.a.number,sender__id:u.a.number,sender__username:u.a.string}))};var We=Re,Fe=t(31),Me=t.n(Fe),Pe=function(e){var n=!!e.room_id,t=Object(r.useState)(n),a=c()(t,2),i=a[0],l=(a[1],Object(r.useState)(!0)),s=c()(l,2),u=s[0],d=s[1],m=Object(r.useState)([]),f=c()(m,2),p=(f[0],f[1]),g=Object(r.useState)(null),b=c()(g,2),h=b[0],x=b[1],v=Object(r.useState)(oe(e.room_id)),y=c()(v,2),w=y[0],E=y[1],S=Object(r.useState)(!0),k=c()(S,2),O=(k[0],k[1]),j=Object(r.useState)(!1),_=c()(j,2),C=_[0],N=_[1],R=Object(r.useState)([]),W=c()(R,2),F=W[0],M=W[1],P=Object(r.useState)(!1),T=c()(P,2),z=(T[0],T[1],Object(r.useState)((function(){try{return document.querySelector("#message_list div div").getAttribute("data-id")}catch(e){return 0}}))),A=c()(z,2),I=A[0],J=A[1],L=Object(r.useState)(""),D=c()(L,2),q=(D[0],D[1]);Object(r.useEffect)((function(){console.log("doing it in chatwidget")}));Object(r.useEffect)((function(){E(oe(e.room_id))}),[e.room_id]),Object(r.useEffect)((function(){try{i&&(d(!0),O(!0),M([]),(n=new WebSocket(w)).binaryType="arraybuffer",x(n),n.onopen=function(){var t=JSON.stringify({message_type:"fetch",room_id:e.room_id,last_fetch_id:I,fetchCount:10});n.send(t)},n.onerror=function(){N(!1)},n.onclose=function(){},n.onmessage=function(e){var n=JSON.parse(e.data);if("fetch_message"===n.message){var t=n.data_message;console.log(t),0===t.length?M([{}]):M(t),O(n.moreAvailable),J(n.last_fetch)}else(n.message="new_message")&&(console.log(n),M((function(e){return[].concat(le()(e),[n])})));setTimeout((function(){N(!1),d(!1)}),5e3)},p([]),q(""))}catch(e){console.debug("In Selected useeffect")}var n}),[w]);var B=!1,U=F.length?void 0!==F[0].id?o.a.createElement(We,{username:e.username,onScroll:function(n){if(!B){B=!0;!function(){var t=n.target;document.querySelector("#message_list").scrollHeight;if(t.scrollTop<20&&!1===C){for(;h.readyState===h.CLOSED;){console.log("connecting to it ......");break}if(h.readyState===h.OPEN){N(!0);var r=JSON.stringify({message_type:"fetch",room_id:e.room_id,last_fetch_id:I,fetchCount:10});console.debug(r),h.send(r)}M(F)}}(),setTimeout((function(){B=!1}),2e3)}},messages:F}):o.a.createElement("p",{style:{textAlign:"center",padding:"10px 20px"}},"No Message to Show"):o.a.createElement("p",null,"Empty"),V=o.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},o.a.createElement(Me.a,{size:150,color:"#123abc",loading:u})),H=u?V:U;return o.a.createElement(o.a.Fragment,null,H,o.a.createElement(Oe,{socket:h,username:e.username,room_id:e.room_id}))},Te=function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{style:{gridRow:"2/3",padding:"inherit",display:"flex",flexFlow:"column",justifyContent:"center",alignItems:"center"}},o.a.createElement("h3",{style:{textAlign:"center"}},"Select Room to Show Messages"),o.a.createElement(B,{href:"#",onClick:e.onClick},"Create New Room")))},ze=t(17);function Ae(){var e=m()(["\n  padding: 10px;\n  div.inputWrapper {\n    display: flex;\n    flex-flow: column;\n    margin-bottom: 10px;\n    label {\n      color: white;\n      font-weight: 800;\n    }\n    .addRoomButtonWrapper {\n      margin-top: 20%;\n      a {\n      }\n    }\n  }\n"]);return Ae=function(){return e},e}function Ie(){var e=m()(["\n  width: 300px;\n  position: absolute;\n  right: 0px;\n  background: rgb(50, 130, 184);\n  height: 100%;\n  h4 {\n    font-weight: 600;\n    color: white;\n    text-align: center;\n  }\n  #addroom-close {\n    display: flex;\n    justify-content: right;\n    svg {\n      font-size: 20px;\n      cursor: pointer;\n    }\n  }\n"]);return Ie=function(){return e},e}function Je(){var e=m()(["\n  width: 100%;\n  height: 100%;\n  background: #cccccc9e;\n  box-shadow: 1px 1px 1px 1px gray;\n  z-index: 1;\n  position: absolute;\n  #addMemberDialog {\n    position: relative;\n    width: 70%;\n    height: 70%;\n    background: white;\n    left: 15%;\n    top: 15%;\n    border-radius: 10px;\n    .dialog-body {\n      padding: 10px;\n      display: flex;\n      flex-flow: column;\n      form {\n        display: flex;\n        flex-flow: column;\n        margin-bottom: 10px;\n        div.basic-multi-select {\n          margin-bottom: 10px;\n        }\n\n        a {\n          justify-self: center;\n          align-self: center;\n        }\n      }\n    }\n  }\n"]);return Je=function(){return e},e}var Le=f.b.div(Je()),De=f.b.div(Ie()),qe=f.b.form(Ae()),Be=window.origin+"/chat/api/room/add",Ue=t(16),Ve=t.n(Ue),He=function(e){var n=Object(r.useState)([]),t=c()(n,2),a=t[0],i=t[1],l=Object(r.useState)([]),s=c()(l,2),u=s[0],d=s[1],m=Object(r.useState)([]),f=c()(m,2),p=f[0],g=f[1];Object(r.useEffect)((function(){return console.info("Spotted")}));var b=function(n){var t;fetch((t=e.room_id,window.origin+"/chat/api/room/"+t+"/members/add"),{method:"POST",body:n,headers:{"Content-Type":"application/json","X-CSRFToken":Ve.a.get("csrftoken")}}).then((function(e){return e.json()})).then((function(e){g(e[0].members)}))},h=function(){var n;fetch((n=e.room_id,window.origin+"/chat/api/room/"+n+"/members")).then((function(e){return e.json()})).then((function(e){i(e.map((function(e){return{value:e.id,label:e.username}})))}))},x=function(){var n;fetch((n=e.room_id,window.origin+"/chat/api/room/"+n+"/existing/members")).then((function(e){return e.json()})).then((function(e){g(e[0].members)}))};Object(r.useEffect)((function(){console.log("Add Member is Working"),h(),x()}),[]);var v=p.length?p.map((function(e){return o.a.createElement("li",{style:{background:"#f0f0f0",padding:"5px"}},e.username)})):o.a.createElement("li",null,"No Member Avalilable"),y=o.a.createElement("form",null,o.a.createElement("label",null,"Select User"),o.a.createElement(ze.a,{options:a,value:u,className:"basic-multi-select",classNamePrefix:"select",isMulti:!0,onChange:function(e){d(e)},style:{marginBottom:"10px"}}),o.a.createElement(B,{onClick:function(){var e=JSON.stringify({members:u.map((function(e){return e.value}))});b(e)}},"Add User"));return o.a.createElement(Le,null,o.a.createElement("div",{id:"addMemberDialog"},o.a.createElement("div",{style:{borderBottom:"1px solid #e8e4e4",padding:"10px",display:"flex",justifyContent:"space-between",alignItems:"center"}},o.a.createElement("h4",{style:{marginBottom:"0px"}},"Add Room Member"),o.a.createElement(ye.h,{style:{fontSize:"1rem"},onClick:e.onClick})),o.a.createElement("div",{className:"dialog-body"},y,o.a.createElement("div",{style:{padding:"5px"}},o.a.createElement("p",{style:{textAlign:"center"}},"Already In Room"),o.a.createElement("ul",{style:{overflowY:"auto"}},v)))))},Ye=t(33),Xe=t.n(Ye);function $e(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Ge(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?$e(Object(t),!0).forEach((function(n){Xe()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):$e(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Ke={findMatching:function(e,n){return console.log("in findMatching"),e.map((function(e){var t={};return n.map((function(e){return e.id})).includes(e.id)?(t=Ge({},e)).status=!0:(t=Ge({},e)).status=!1,t}))},changeValue:function(e,n,t){try{var r=e.map((function(e){return e.id}));return n.map((function(e){return r.includes(e.id)?Ge({},e,{status:t}):Ge({},e)}))}catch(e){return console.log("fuck changevalue"),[]}}};function Qe(){var e=m()(["\n  width: 30%;\n  height: 30%;\n  max-height: 300px;\n  min-height: 200px;\n  background: white;\n  position: absolute;\n  box-shadow: 2px 2px 2px 3px #c4bbbb;\n  padding: 12px;\n  left: 50%;\n  top: 50%;\n  margin-left: -100px;\n  margin-top: -100px;\n  svg {\n    position: absolute;\n    top: -8px;\n    right: -8px;\n    cursor: pointer;\n  }\n  div.userDetails {\n    div {\n      display: flex;\n    }\n  }\n"]);return Qe=function(){return e},e}function Ze(){var e=m()(["\n  display: flex;\n  overflow-x: auto;\n\n  div.userName {\n    margin: 5px;\n    background: aliceblue;\n    display: flex;\n    align-items: center;\n    justify-content: space-around;\n    cursor: pointer;\n    &:hover {\n      background: #e0f3ff;\n    }\n  }\n"]);return Ze=function(){return e},e}function en(){var e=m()(["\n  margin: 10px;\n"]);return en=function(){return e},e}function nn(){var e=m()(["\n  width: 10px;\n  height: 10px;\n  background: ",";\n  border-radius: 10px;\n  margin: 10px;\n"]);return nn=function(){return e},e}var tn=f.b.div(nn(),(function(e){return e.status?"lightgreen":"red"})),rn=f.b.div(en()),on=f.b.div(Ze()),an=(f.b.div(Qe()),function(e){return console.log(e.members),o.a.createElement(on,null,e.members.map((function(n,t){return o.a.createElement("div",{className:"userName",onClick:function(){return e.onClick(n.id)},key:t},o.a.createElement(tn,{status:n.status}," "),o.a.createElement(rn,null,n.username))})))});an.propTypes={members:u.a.arrayOf(u.a.shape({id:u.a.string,name:u.a.string,member:u.a.arrayOf(u.a.number)}))};var ln=an,cn=function(e){var n=Object(r.useState)(),t=c()(n,2),a=(t[0],t[1],Object(r.useState)()),i=c()(a,2);i[0],i[1];return o.a.createElement(o.a.Fragment,null,o.a.createElement(ln,{members:e.memberList}))};function sn(){this.number=0,this.autoReconnectInterval=5e3}sn.prototype.open=function(e){var n=this;this.url=e,this.instance=new WebSocket(this.url),console.log("In WebSocket"+this.url),this.instance.addEventListener("open",(function(){n.onopen()})),this.instance.addEventListener("message",(function(e,t){n.number++,n.onmessage(e,t,n.number)})),this.instance.addEventListener("close",(function(e){switch(e.code){case 1e3:console.log("WebSocket: closed");break;default:n.reconnect(e)}n.onclose(e)})),this.instance.addEventListener("error",(function(e){switch(e.code){case"ECONNREFUSED":n.reconnect(e);break;default:n.onerror(e)}}))},sn.prototype.send=function(e){try{this.instance.send(e)}catch(e){console.log("emit error")}},sn.prototype.reconnect=function(e){console.log("WebSocketClient: retry in "+this.autoReconnectInterval,e),this.instance.removeEventListener("open",(function(){})),this.instance.removeEventListener("error",(function(){})),this.instance.removeEventListener("message",(function(){})),this.instance.removeEventListener("close",(function(){}));var n=this;setTimeout((function(){console.log("WebSocketClient: reconnecting..."),n.open(n.url)}),this.autoReconnectInterval)},sn.prototype.onopen=function(e){console.log("WebSocketClient: open",arguments)},sn.prototype.onmessage=function(e,n,t){console.log("WebSocketClient: message",arguments)},sn.prototype.onerror=function(e){console.log("WebSocketClient: error",arguments)},sn.prototype.onclose=function(e){console.log("WebSocketClient: closed",arguments)};var un=sn,dn=function(){try{return document.querySelector("#message_list div div").getAttribute("data-id")}catch(e){return 0}},mn=function(e){var n=Object(r.useState)([]),t=c()(n,2),a=t[0],i=t[1],l=Object(r.useState)(new un),s=c()(l,2),u=s[0],d=(s[1],Object(r.useState)(ae())),m=c()(d,2),f=m[0];m[1];un.prototype.onmessage=function(e){switch(e=JSON.parse(e.data),console.log(e),console.log("new data-----------------------------------------------------------"),e.message){case"users":var n=Ke.findMatching(e.all_members,e.live_members);i(n);break;case"update":if(console.log("updated"),a)if(0===a.length)console.info("pre");else{console.info(a);try{var t=Ke.changeValue(e.update_user,a,!0);console.info(t),i(t)}catch(e){console.log("update error")}console.info("post")}break;case"remove":console.info("removed"),a&&(0===a.length?console.log("pre"):(i(Ke.changeValue(e.update_user,a,!1)),console.log("post")));break;default:console.info("not valid")}};var p=!!e.room_id,g=Object(r.useState)(p),b=c()(g,2),h=b[0],x=b[1],v=Object(r.useState)(!0),y=c()(v,2),w=(y[0],y[1],Object(r.useState)(!1)),E=c()(w,2),S=E[0],k=E[1],O=Object(r.useState)(null),j=c()(O,2),_=(j[0],j[1],Object(r.useState)(oe(e.room_id))),C=c()(_,2),N=(C[0],C[1],Object(r.useState)(!0)),R=c()(N,2),W=(R[0],R[1],Object(r.useState)(!1)),F=c()(W,2),M=(F[0],F[1],Object(r.useState)([])),P=c()(M,2),T=(P[0],P[1],Object(r.useState)(!1)),z=c()(T,2),A=(z[0],z[1],Object(r.useState)(dn)),I=c()(A,2);I[0],I[1];Object(r.useEffect)((function(){x(p)}),[e.room_id]),Object(r.useEffect)((function(){console.debug("memberList"),console.debug(a)}),[a]),Object(r.useEffect)((function(){u.open(f)}),[u]),Object(r.useEffect)((function(){console.log("Yaaho");var n=JSON.stringify({type:"fetch.status",room_id:e.room_id});console.debug(n),u.send(n)}),[e.room_id]);var J=function(){k(!S);var n=JSON.stringify({type:"fetch.status",room_id:e.room_id});console.debug(n),u.send(n)};var L=o.a.createElement(o.a.Fragment,null,S?o.a.createElement(He,{room_id:e.room_id,onClick:J}):"",o.a.createElement(te,null,o.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},o.a.createElement(re,null,"Room Id:",e.room_name," "),o.a.createElement("div",{style:{padding:"10px",background:"#e8e5e5"}},o.a.createElement(ye.g,{style:{fontSize:"20px"},onClick:J}))),o.a.createElement(cn,{room_id:e.room_id,memberList:a})),o.a.createElement(Pe,{room_id:e.room_id,username:e.username})),D=h?L:o.a.createElement(Te,{onClick:e.onClick});return o.a.createElement(ne,null,D," ")};mn.propTypes={room_name:u.a.string,room_id:u.a.string};var fn=mn,pn=t(34),gn=t.n(pn),bn=window.origin+"/chat/api/company/users";console.log(Be);var hn=function(e){return o.a.createElement(V,null,o.a.createElement("img",{src:gn.a}))},xn=function(e){var n=Object(r.useState)(),t=c()(n,2),a=t[0],i=t[1],l=Object(r.useState)(),s=c()(l,2),u=s[0],d=s[1],m=Object(r.useState)(),f=c()(m,2),p=f[0],g=f[1],b=Object(r.useState)(!1),h=c()(b,2),x=h[0],v=h[1];return Object(r.useEffect)((function(){fetch(bn).then((function(e){return e.json()})).then((function(e){g(e.map((function(e){return{value:e.id,label:e.username}})))}))}),[]),o.a.createElement(De,{id:"add-room-dialog"},x?o.a.createElement(hn,null):"",o.a.createElement("div",{id:"addroom-close"},o.a.createElement(ye.h,{onClick:e.onClick})),o.a.createElement("div",null,o.a.createElement("h4",null,"Create Room"),o.a.createElement(qe,null,o.a.createElement("div",{className:"inputWrapper"},o.a.createElement("label",null,"Room Name"),o.a.createElement(U,{placeholder:"Enter Room Name",name:"room_name",onChange:function(e){i(e.target.value)},value:a})),o.a.createElement("div",{className:"inputWrapper"},o.a.createElement("label",null,"Members"),o.a.createElement(ze.a,{options:p,value:u,className:"basic-multi-select",classNamePrefix:"select",isMulti:!0,onChange:function(e){d(e)}})),o.a.createElement("div",{className:"inputWrapper  addRoomButtonWrapper"},o.a.createElement(B,{light:!0,onClick:function(){v(!0);var n=new FormData;n.append("name","Testing3"),n.append("members",JSON.stringify([1,2]));var t={name:a,members:u.map((function(e){return e.value}))},r={method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json","X-CSRFToken":Ve.a.get("csrftoken")}};fetch(Be,r).then((function(e){return e.json()})).then((function(n){console.log(n),i(""),d([]),e.onAddRoom()})).catch((function(e){return console.log("error",e)})),v(!1)}},"Create Room")))))};var vn=function(){var e=JSON.parse(document.querySelector("#username").textContent),n=JSON.parse(document.querySelector("#user_id").textContent),t=Object(r.useState)(e),a=c()(t,2),i=a[0],l=(a[1],Object(r.useState)(n)),s=c()(l,2),u=(s[0],s[1],Object(r.useState)("")),d=c()(u,2),m=d[0],f=d[1],p=Object(r.useState)(""),g=c()(p,2),b=g[0],h=g[1],x=Object(r.useState)(""),v=c()(x,2),y=(v[0],v[1],Object(r.useState)(!1)),w=c()(y,2),E=w[0],k=w[1],O=Object(r.useState)(!1),j=c()(O,2),_=j[0],C=j[1];return o.a.createElement(q,null,o.a.createElement(S,{onClick:function(e){var n=e.target;h(n.textContent),f(n.getAttribute("data-id"))},refresh:_,dataRefreshed:function(){C(!1)}}),o.a.createElement(fn,{room_name:b,room_id:m,username:i,onClick:function(e){k(!0)}}),E?o.a.createElement(xn,{onClick:function(e){console.log("close it bitch"),k(!1)},onAddRoom:function(){C(!0),console.log("room added  triggered")}}):"")};function yn(){var e=m()(["\n     *{\n         box-sizing: border-box;\n     }\n\n html,body{\n     font-family: Lato,Helvetica;\n     width: 100vw;\n     overflow-x:hidden;\n     margin:0;\n     padding:0;\n }\n\n ul{\n     list-style:none;\n     padding:0;\n }\n\n a{\n     text-decoration: none;\n\n     &:visited{\n         color:inherit;\n     }\n }\n "]);return yn=function(){return e},e}var wn=Object(f.a)(yn()),En=t(35);i.a.render(o.a.createElement("div",null,o.a.createElement(o.a.StrictMode,null,o.a.createElement(wn,null),o.a.createElement(vn,null))),document.getElementById("root")),En.a()}});